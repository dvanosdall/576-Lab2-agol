<!DOCTYPE html>
<html lang="en">

<head>
    <title>Hello, AGOL!</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="description" content="" />

    <!-- ArcGIS apis and css file js library -->
    <link rel="stylesheet" href="https://js.arcgis.com/4.25/esri/themes/light/main.css">
    <script src="https://js.arcgis.com/4.25/"></script>

    <!-- modules for the the full screen map -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            require(["esri/config",
                "esri/Map",
                "esri/views/MapView",
                "esri/widgets/BasemapGallery",
                "esri/widgets/Expand",
                "esri/widgets/Locate",
                "esri/widgets/Search",
                "esri/Graphic",
                "esri/layers/GraphicsLayer",
                "esri/layers/FeatureLayer"
            ], function (
                esriConfig,
                Map,
                MapView,
                BasemapGallery,
                Expand,
                Locate,
                Search,
                Graphic,
                GraphicsLayer,
                FeatureLayer
            ) {
                esriConfig.apiKey = "AAPTxy8BH1VEsoebNVZXo8HurA7KuWFcKWHkeJGoN8LUQ0kg89t8Mp9cvPVKOEIlsdPNLfXn5b7CCVz-TOsYcUlMoSeMzi8wk5dok7tlJEH1AT1D08Fi4R08Yc-PqHpmdRfewyDZ3eKIjCxRy2ypQ7t_XLIUEo5TrWCxuzoL-CiULHI9PILuzJZ9AY1270cOvy30f3K9Jl_RnHOWwK1AQpkEKmKK3fbIhSplvXWfswyP60ZOP7jizaZoFHiwlIPf7-kQAT1_oy0SXwjE";

                const earthquakeLayer = new FeatureLayer({
                    url: "https://services3.arcgis.com/7bJVHfju2RXdGZa4/arcgis/rest/services/UK_Historical_Earthquakes/FeatureServer/0",
                    outFields: ["*"],
                    popupTemplate: {
                        title: "Historical Earthquakes -- Earthquake at {LOCALITY}",
                        content: `<b>Date:</b> {DY_MO_YEAR} <br/>
                                    <b>Time (HR:MN:SS):</b> {HRMN} : {SECS} <br/>
                                    <b>Magnitude (MAG):</b> {MAG} <br/>
                                    <b>Depth (km):</b> {DEP} <br/>
                                    <b>Latitude:</b> {LAT} <br/>
                                    <b>Longitude:</b> {LON} <br/>
                                    <b>Intensity:</b> {INT} <br/>
                                    <b>Comments:</b> {COMMENTS} <br/>
                                    <br/>
                                    <i>Note: Magnitude sizes on the map reflect the earthquake strength (MAG).</i>`
                    }
                });

                const map = new Map({
                    // Basemap layer - city names
                    basemap: "arcgis-newspaper",
                    layers: [earthquakeLayer]
                });

                const view = new MapView({
                    map: map,
                    // Longitude, latitude for Liverpool FC stadium Anfield in the UK
                    center: [-2.961425, 53.430759],
                    // Div element
                    container: "viewDiv",
                    // Detailed view
                    scale: 2500000
                });

                // addding the constructor for the graphics layer
                const graphicsLayer = new GraphicsLayer();
                map.add(graphicsLayer);

                const point = { //Create a point
                    type: "point",
                    longitude: -2.961425,    //long lat of Liverpool FC stadium (anfield)
                    latitude: 53.430759
                };

                const simpleMarkerSymbol = {
                    type: "simple-marker",
                    style: "diamond",
                    color: [200, 16, 46],
                    outline: {
                        color: [255, 255, 255],
                        width: 1
                    }
                };

                const popupTemplate = {
                    title: "{Name}",
                    content: "{Description}"
                }
                const attributes = {
                    Name: "Anfield Stadium, Liverpool FC",
                    Description: "This is the home stadium of Liverpool FC, now the most successful football club in England."
                }

                const pointGraphic = new Graphic({
                    geometry: point,
                    symbol: simpleMarkerSymbol,

                    attributes: attributes,
                    popupTemplate: popupTemplate
                });

                // A sample route walking route near Anfield
                const polyline = {
                    type: "polyline",
                    paths: [
                        [-2.9705, 53.4300],
                        [-2.9685, 53.4302],
                        [-2.9650, 53.4305],
                        [-2.9614, 53.4308],
                        [-2.9585, 53.4310]
                    ]
                };

                const polylineSymbol = {
                    type: "simple-line",
                    color: [246, 235, 97],
                    width: 2
                };

                const polylineAttributes = {
                    Name: "Matchday Route",
                    Description: "Common walking route to Anfield Stadium from surrounding streets."
                };

                const polylinePopup = {
                    title: "{Name}",
                    content: "{Description}"
                };

                const polylineGraphic = new Graphic({
                    geometry: polyline,
                    symbol: polylineSymbol,
                    attributes: polylineAttributes,
                    popupTemplate: polylinePopup
                });

                // Area around Anfield Stadium
                const polygon = {
                    type: "polygon",
                    rings: [
                        [-2.9642, 53.4316],
                        [-2.9586, 53.4316],
                        [-2.9586, 53.4300],
                        [-2.9642, 53.4300],
                        [-2.9642, 53.4316]
                    ]
                };

                const polygonSymbol = {
                    type: "simple-fill",
                    color: [0, 255, 0, 0.3], // transparent green
                    outline: {
                        color: [0, 178, 169],
                        width: 1
                    }
                };

                const polygonAttributes = {
                    Name: "Anfield Grounds",
                    Description: "Approximate area of Anfield Stadium grounds."
                };

                const polygonPopup = {
                    title: "{Name}",
                    content: "{Description}"
                };

                const polygonGraphic = new Graphic({
                    geometry: polygon,
                    symbol: polygonSymbol,
                    attributes: polygonAttributes,
                    popupTemplate: polygonPopup
                });

                graphicsLayer.add(pointGraphic);
                graphicsLayer.add(polylineGraphic);
                graphicsLayer.add(polygonGraphic);

                // Create BasemapGallery widget
                const basemapGallery = new BasemapGallery({
                    view: view
                });

                // Optionally wrap in Expand widget to toggle visibility
                const bgExpand = new Expand({
                    view: view,
                    content: basemapGallery,
                    expandIconClass: "esri-icon-basemap",
                    group: "top-right"
                });

                // Add the expand widget with the basemap gallery to the UI
                view.ui.add(bgExpand, {
                    position: "top-right"
                });

                // Locate widget: adds button to center map on user location
                const locateWidget = new Locate({
                    view: view,
                    useHeadingEnabled: false,
                    goToOverride: (view, options) => {
                        // Zoom in when centering
                        options.target.scale = 1500;
                        return view.goTo(options.target);
                    }
                });
                view.ui.add(locateWidget, "top-left");

                // Search widget
                const searchWidget = new Search({
                    view: view,
                    popupEnabled: true,
                });
                view.ui.add(searchWidget, {
                    position: "top-left",
                    index: 1
                });
            });
        });
    </script>

    <!-- style -->
    <style>
        html,
        body,
        #viewDiv {
            padding: 0;
            margin: 0;
            height: 100%;
            width: 100%;
        }
    </style>

</head>

<body>
    <!-- div for map display -->
    <div id="viewDiv"></div>
</body>

</html>